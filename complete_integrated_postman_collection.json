{
  "info": {
    "name": "Ulog Backend - 完整API集合",
    "description": "整合了认证、用户管理、联系人管理、对话式信息收集和用户自我信息收集的完整API测试集合",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "auth": {
    "type": "bearer",
    "bearer": [
      {
        "key": "token",
        "value": "{{accessToken}}",
        "type": "string"
      }
    ]
  },
  "variable": [
    {
      "key": "baseUrl",
      "value": "http://localhost:8080",
      "type": "string"
    },
    {
      "key": "accessToken",
      "value": "",
      "type": "string"
    },
    {
      "key": "refreshToken",
      "value": "",
      "type": "string"
    },
    {
      "key": "sessionId",
      "value": "",
      "type": "string"
    },
    {
      "key": "contactId",
      "value": "",
      "type": "string"
    },
    {
      "key": "userSessionId",
      "value": "",
      "type": "string"
    },
    {
      "key": "goalId",
      "value": "",
      "type": "string"
    },
    {
      "key": "planId",
      "value": "",
      "type": "string"
    },
    {
      "key": "tokenId",
      "value": "",
      "type": "string"
    },
    {
      "key": "pinId",
      "value": "",
      "type": "string"
    },
    {
      "key": "qaIndex",
      "value": "",
      "type": "string"
    }
  ],
  "item": [
    {
      "name": "🔐 认证模块",
      "description": "用户注册、登录、刷新token、登出",
      "item": [
        {
          "name": "1) 注册用户",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    console.log('✅ 用户注册成功');",
                  "    const response = pm.response.json();",
                  "    console.log('用户ID:', response.data.id);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"phone\": \"+1234567890\",\n  \"password\": \"Test123456\",\n  \"name\": \"测试用户\",\n  \"smsCode\": \"123456\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/auth/register",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "auth", "register"]
            },
            "description": "注册新用户"
          }
        },
        {
          "name": "2) 登录获取Token",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    if (response.data && response.data.tokens) {",
                  "        pm.collectionVariables.set('accessToken', response.data.tokens.accessToken);",
                  "        pm.collectionVariables.set('refreshToken', response.data.tokens.refreshToken);",
                  "        console.log('✅ 登录成功，Token已保存');",
                  "        console.log('Access Token:', response.data.tokens.accessToken.substring(0, 20) + '...');",
                  "    }",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"phone\": \"+1234567890\",\n  \"password\": \"Test123456\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/auth/login",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "auth", "login"]
            },
            "description": "用户登录并获取JWT token"
          }
        },
        {
          "name": "3) 刷新Token",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"refreshToken\": \"{{refreshToken}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/auth/refresh",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "auth", "refresh"]
            },
            "description": "使用refresh token刷新access token"
          }
        },
        {
          "name": "4) 登出",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"refreshToken\": \"{{refreshToken}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/auth/logout",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "auth", "logout"]
            },
            "description": "用户登出并失效refresh token"
          }
        }
      ]
    },
    {
      "name": "👤 用户管理",
      "description": "用户信息管理相关API",
      "item": [
        {
          "name": "1) 获取当前用户信息",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/v1/users/me",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "users", "me"]
            },
            "description": "获取当前登录用户的信息"
          }
        },
        {
          "name": "2) 更新用户信息",
          "request": {
            "method": "PATCH",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"更新后的用户名\",\n  \"description\": \"更新后的用户描述\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/users/me",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "users", "me"]
            },
            "description": "更新当前用户信息"
          }
        },
        {
          "name": "3) 修改密码",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    console.log('✅ 密码修改成功');",
                  "    console.log('⚠️ 请使用新密码重新登录');",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"currentPassword\": \"Test123456\",\n  \"newPassword\": \"NewPassword123\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/users/me/password",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "users", "me", "password"]
            },
            "description": "修改用户密码"
          }
        },
        {
          "name": "4) 注销账户",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    console.log('✅ 账户注销成功');",
                  "    console.log('🗑️ 用户数据已软删除');",
                  "    console.log('🔒 所有Token已撤销');",
                  "    console.log('📋 操作已记录到审计日志');",
                  "    ",
                  "    // 清除保存的Token",
                  "    pm.collectionVariables.set('accessToken', '');",
                  "    pm.collectionVariables.set('refreshToken', '');",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"password\": \"Test123456\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/users/me",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "users", "me"]
            },
            "description": "注销当前用户账户（软删除，需要密码验证）。此操作会：1) 标记用户为已删除 2) 撤销所有Token 3) 软删除所有关联数据（联系人、目标等） 4) 记录审计日志"
          }
        }
      ]
    },
    {
      "name": "📞 传统联系人管理",
      "description": "传统的CRUD联系人管理API",
      "item": [
        {
          "name": "1) 创建联系人",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    const response = pm.response.json();",
                  "    if (response.data && response.data.id) {",
                  "        pm.collectionVariables.set('contactId', response.data.id);",
                  "        console.log('✅ 联系人创建成功，ID:', response.data.id);",
                  "    }",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"张三\",\n  \"description\": \"工作伙伴，喜欢喝咖啡，下周三在上海\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/contacts",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "contacts"]
            },
            "description": "创建新联系人"
          }
        },
        {
          "name": "2) 获取所有联系人",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/v1/contacts",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "contacts"]
            },
            "description": "获取当前用户的所有联系人"
          }
        },
        {
          "name": "3) 获取联系人详情",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/v1/contacts/{{contactId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "contacts", "{{contactId}}"]
            },
            "description": "获取指定联系人的详细信息"
          }
        },
        {
          "name": "4) 更新联系人",
          "request": {
            "method": "PATCH",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"张三 (更新)\",\n  \"description\": \"更新后的描述：工作伙伴，喜欢喝咖啡和茶，下周三在上海，考虑合作播客\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/contacts/{{contactId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "contacts", "{{contactId}}"]
            },
            "description": "更新指定联系人的信息"
          }
        },
        {
          "name": "5) 删除联系人",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/v1/contacts/{{contactId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "contacts", "{{contactId}}"]
            },
            "description": "删除指定联系人（软删除）"
          }
        },
        {
          "name": "6) 预览Aibook",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"contactDescriptionOverride\": null,\n  \"userDescriptionOverride\": null,\n  \"language\": \"zh\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/contacts/{{contactId}}/aibook/preview",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "contacts", "{{contactId}}", "aibook", "preview"]
            },
            "description": "为联系人生成AI关系洞察（aibook）"
          }
        }
      ]
    },
    {
      "name": "🤖 对话式信息收集",
      "description": "智能对话收集联系人信息，支持多轮对话、信息修正、问答模式",
      "item": [
        {
          "name": "开始收集",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    const response = pm.response.json();",
                  "    if (response.data && response.data.sessionId) {",
                  "        pm.collectionVariables.set('sessionId', response.data.sessionId);",
                  "        console.log('✅ 对话会话开始:', response.data.sessionId);",
                  "        console.log('📝 第一个问题:', response.data.firstQuestion);",
                  "    }",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"contactName\": \"张三\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/conversation/collect/start",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "conversation", "collect", "start"]
            },
            "description": "开始一个新的信息收集会话"
          }
        },
        {
          "name": "回答问题-第1轮",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    console.log('📝 下一个问题:', response.data.nextQuestion);",
                  "    console.log('📊 进度:', response.data.progress + '%');",
                  "    console.log('🎯 当前维度:', response.data.currentDimension);",
                  "    ",
                  "    if (response.data.isCompleted && response.data.contact) {",
                  "        pm.collectionVariables.set('contactId', response.data.contact.id);",
                  "        console.log('✅ 联系人创建成功:', response.data.contact.id);",
                  "    }",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"message\": \"30岁左右\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/conversation/collect/{{sessionId}}/message",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "conversation", "collect", "{{sessionId}}", "message"]
            },
            "description": "回答第一个问题：年龄"
          }
        },
        {
          "name": "回答问题-第2轮",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"message\": \"是个产品经理，在互联网公司工作\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/conversation/collect/{{sessionId}}/message",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "conversation", "collect", "{{sessionId}}", "message"]
            },
            "description": "回答职业相关问题"
          }
        },
        {
          "name": "修正信息",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"message\": \"不对，他其实是35岁\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/conversation/collect/{{sessionId}}/message",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "conversation", "collect", "{{sessionId}}", "message"]
            },
            "description": "测试信息修正功能"
          }
        },
        {
          "name": "提前结束",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    if (response.data.isCompleted && response.data.contact) {",
                  "        pm.collectionVariables.set('contactId', response.data.contact.id);",
                  "        console.log('✅ 联系人创建成功:', response.data.contact);",
                  "        console.log('💬 完成消息:', response.data.completionMessage);",
                  "    } else if (response.data.isConfirmingEnd) {",
                  "        console.log('❓ 正在确认结束...');",
                  "    } else if (response.data.needsMinimumInfo) {",
                  "        console.log('⚠️ 需要补充最低信息');",
                  "    }",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"message\": \"就这些吧，不想继续了\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/conversation/collect/{{sessionId}}/message",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "conversation", "collect", "{{sessionId}}", "message"]
            },
            "description": "测试提前结束功能"
          }
        },
        {
          "name": "查看进度",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/v1/conversation/collect/{{sessionId}}/progress",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "conversation", "collect", "{{sessionId}}", "progress"]
            },
            "description": "查看当前收集进度"
          }
        },
        {
          "name": "放弃会话",
          "request": {
            "method": "POST",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/v1/conversation/collect/{{sessionId}}/abandon",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "conversation", "collect", "{{sessionId}}", "abandon"]
            },
            "description": "放弃当前会话"
          }
        }
      ]
    },
    {
      "name": "💬 问答模式",
      "description": "联系人创建后的问答交互",
      "item": [
        {
          "name": "智能问答-第1轮",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    console.log('📝 QA Response:', response.data);",
                  "    ",
                  "    if (response.data.needsMoreInfo) {",
                  "        console.log('⚠️ 需要补充信息:', response.data.supplementQuestion);",
                  "        console.log('🔍 分析结果:', response.data.analysis);",
                  "    } else {",
                  "        console.log('✅ 直接回答:', response.data.answer);",
                  "    }",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"message\": \"张三和我的关系如何？\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/conversation/qa/{{sessionId}}/message",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "conversation", "qa", "{{sessionId}}", "message"]
            },
            "description": "测试智能问答 - 可能需要补充信息的问题"
          }
        },
        {
          "name": "补充信息",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    console.log('✅ 补充信息完成:', response.data.answer);",
                  "    console.log('📊 是否为补充回答:', response.data.isSupplementAnswer);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"supplementInfo\": \"我们是大学同学，经常一起讨论技术问题，关系很好\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/conversation/qa/{{sessionId}}/supplement",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "conversation", "qa", "{{sessionId}}", "supplement"]
            },
            "description": "补充信息 - 提供额外信息后生成最终回答"
          }
        },
        {
          "name": "智能问答-第2轮",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    console.log('✅ 直接回答:', response.data.answer);",
                  "    console.log('📊 是否需要补充信息:', response.data.needsMoreInfo);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"message\": \"张三的职业是什么？\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/conversation/qa/{{sessionId}}/message",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "conversation", "qa", "{{sessionId}}", "message"]
            },
            "description": "测试智能问答 - 不需要补充信息的问题"
          }
        },
        {
          "name": "智能问答-第3轮",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"message\": \"我们平时是如何互动的？\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/conversation/qa/{{sessionId}}/message",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "conversation", "qa", "{{sessionId}}", "message"]
            },
            "description": "测试智能问答 - 可能需要补充信息的问题"
          }
        },
        {
          "name": "生成AI总结",
          "request": {
            "method": "POST",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/v1/conversation/qa/{{sessionId}}/generate-summary",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "conversation", "qa", "{{sessionId}}", "generate-summary"]
            },
            "description": "为联系人生成AI总结"
          }
        },
        {
          "name": "结束会话",
          "request": {
            "method": "POST",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/v1/conversation/qa/{{sessionId}}/end",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "conversation", "qa", "{{sessionId}}", "end"]
            },
            "description": "结束问答会话"
          }
        }
      ]
    },
    {
      "name": "🚀 完整流程测试",
      "description": "端到端的完整测试流程",
      "item": [
        {
          "name": "完整流程-开始对话",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    const response = pm.response.json();",
                  "    pm.collectionVariables.set('sessionId', response.data.sessionId);",
                  "    console.log('🚀 完整流程开始，Session ID:', response.data.sessionId);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"contactName\": \"李四\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/conversation/collect/start",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "conversation", "collect", "start"]
            }
          }
        },
        {
          "name": "完整流程-多轮对话",
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "exec": [
                  "// 模拟多轮对话",
                  "const answers = [",
                  "    '28岁',",
                  "    '软件工程师，在创业公司',",
                  "    '大学同学',",
                  "    '我们每周都会聊天，关系很好',",
                  "    '就这些吧'",
                  "];",
                  "",
                  "const currentRound = pm.collectionVariables.get('currentRound') || 0;",
                  "pm.request.body.raw = JSON.stringify({",
                  "    message: answers[currentRound]",
                  "});",
                  "pm.collectionVariables.set('currentRound', currentRound + 1);"
                ],
                "type": "text/javascript"
              }
            },
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    console.log('Response:', response.data);",
                  "    ",
                  "    if (response.data.isCompleted) {",
                  "        pm.collectionVariables.set('contactId', response.data.contact.id);",
                  "        console.log('✅ 联系人创建成功！');",
                  "        pm.collectionVariables.set('currentRound', 0);",
                  "    }",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"message\": \"动态设置\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/conversation/collect/{{sessionId}}/message",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "conversation", "collect", "{{sessionId}}", "message"]
            },
            "description": "多次运行此请求以模拟完整对话流程"
          }
        },
        {
          "name": "完整流程-查看创建的联系人",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/v1/contacts/{{contactId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "contacts", "{{contactId}}"]
            },
            "description": "查看通过对话创建的联系人"
          }
        },
        {
          "name": "完整流程-QA智能问答",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    console.log('🤖 QA智能问答响应:', response.data);",
                  "    ",
                  "    if (response.data.needsMoreInfo) {",
                  "        console.log('⚠️ 需要补充信息，请运行补充信息请求');",
                  "    } else {",
                  "        console.log('✅ 直接回答完成');",
                  "    }",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"message\": \"李四和我的关系如何？我们平时是怎么相处的？\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/conversation/qa/{{sessionId}}/message",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "conversation", "qa", "{{sessionId}}", "message"]
            },
            "description": "完整流程测试 - QA智能问答"
          }
        },
        {
          "name": "完整流程-补充信息",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    console.log('✅ 补充信息完成，最终回答:', response.data.answer);",
                  "    console.log('📊 是否为补充回答:', response.data.isSupplementAnswer);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"supplementInfo\": \"我们是同事关系，平时经常一起吃饭聊天，也会讨论工作上的问题，关系比较融洽\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/conversation/qa/{{sessionId}}/supplement",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "conversation", "qa", "{{sessionId}}", "supplement"]
            },
            "description": "完整流程测试 - 补充信息"
          }
        },
        {
          "name": "完整流程-生成AI总结",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    console.log('🎯 AI总结生成完成:', response.data);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/v1/conversation/qa/{{sessionId}}/generate-summary",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "conversation", "qa", "{{sessionId}}", "generate-summary"]
            },
            "description": "完整流程测试 - 生成AI总结"
          }
        }
      ]
    },
    {
      "name": "👤 用户自我信息收集",
      "description": "用户通过对话收集自己的个人信息，更新User.description",
      "item": [
        {
          "name": "开始用户自我收集",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    const response = pm.response.json();",
                  "    if (response.data && response.data.sessionId) {",
                  "        pm.collectionVariables.set('userSessionId', response.data.sessionId);",
                  "        console.log('✅ 用户自我信息收集会话开始:', response.data.sessionId);",
                  "        console.log('📝 第一个问题:', response.data.firstQuestion);",
                  "        console.log('💬 提示:', response.data.message);",
                  "    }",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/v1/user-conversation/collect/start",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "user-conversation", "collect", "start"]
            },
            "description": "开始用户自我信息收集会话"
          }
        },
        {
          "name": "回答问题-第1轮(年龄)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    console.log('📝 下一个问题:', response.data.nextQuestion);",
                  "    console.log('📊 进度:', response.data.progress + '%');",
                  "    console.log('🎯 当前维度:', response.data.currentDimension);",
                  "    ",
                  "    if (response.data.isCompleted) {",
                  "        console.log('✅ 信息收集完成!');",
                  "        console.log('📄 更新后的描述:', response.data.updatedDescription);",
                  "        console.log('🎉 可以进入QA模式了!');",
                  "    }",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"message\": \"30岁\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/user-conversation/collect/{{userSessionId}}/message",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "user-conversation", "collect", "{{userSessionId}}", "message"]
            },
            "description": "回答第一个问题：年龄"
          }
        },
        {
          "name": "回答问题-第2轮(职业)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"message\": \"我是一名产品经理，在互联网公司工作\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/user-conversation/collect/{{userSessionId}}/message",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "user-conversation", "collect", "{{userSessionId}}", "message"]
            },
            "description": "回答职业相关问题"
          }
        },
        {
          "name": "回答问题-第3轮(教育)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"message\": \"本科毕业，计算机专业\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/user-conversation/collect/{{userSessionId}}/message",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "user-conversation", "collect", "{{userSessionId}}", "message"]
            },
            "description": "回答教育背景问题"
          }
        },
        {
          "name": "修正信息",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"message\": \"不对，我其实是32岁\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/user-conversation/collect/{{userSessionId}}/message",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "user-conversation", "collect", "{{userSessionId}}", "message"]
            },
            "description": "测试信息修正功能"
          }
        },
        {
          "name": "提前结束",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    if (response.data.isCompleted) {",
                  "        console.log('✅ 用户信息收集完成!');",
                  "        console.log('📄 自我描述:', response.data.updatedDescription);",
                  "        console.log('💬 完成消息:', response.data.completionMessage);",
                  "        console.log('🎯 下一步:', response.data.nextMode);",
                  "    } else if (response.data.isConfirmingEnd) {",
                  "        console.log('❓ 正在确认结束...');",
                  "    } else if (response.data.needsMinimumInfo) {",
                  "        console.log('⚠️ 需要补充最低信息');",
                  "    }",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"message\": \"就这些吧，结束问卷\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/user-conversation/collect/{{userSessionId}}/message",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "user-conversation", "collect", "{{userSessionId}}", "message"]
            },
            "description": "测试提前结束功能"
          }
        },
        {
          "name": "确认结束",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    if (response.data.isCompleted) {",
                  "        console.log('✅ 用户信息收集完成!');",
                  "        console.log('📄 自我描述:', response.data.updatedDescription);",
                  "        console.log('🎯 进入QA模式:', response.data.nextMode);",
                  "    }",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"message\": \"是\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/user-conversation/collect/{{userSessionId}}/message",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "user-conversation", "collect", "{{userSessionId}}", "message"]
            },
            "description": "确认结束信息收集"
          }
        },
        {
          "name": "查看进度",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/v1/user-conversation/collect/{{userSessionId}}/progress",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "user-conversation", "collect", "{{userSessionId}}", "progress"]
            },
            "description": "查看当前收集进度"
          }
        },
        {
          "name": "放弃会话",
          "request": {
            "method": "POST",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/v1/user-conversation/collect/{{userSessionId}}/abandon",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "user-conversation", "collect", "{{userSessionId}}", "abandon"]
            },
            "description": "放弃当前会话"
          }
        }
      ]
    },
    {
      "name": "🤔 用户自我QA模式",
      "description": "用户信息收集完成后，基于自我描述进行问答",
      "item": [
        {
          "name": "自我QA-第1轮",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    console.log('📝 QA Response:', response.data);",
                  "    ",
                  "    if (response.data.needsMoreInfo) {",
                  "        console.log('⚠️ 需要补充信息:', response.data.followUpQuestion);",
                  "    } else {",
                  "        console.log('✅ 直接回答:', response.data.answer);",
                  "    }",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"message\": \"我的优势是什么？\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/user-conversation/qa/{{userSessionId}}/message",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "user-conversation", "qa", "{{userSessionId}}", "message"]
            },
            "description": "测试自我问答"
          }
        },
        {
          "name": "自我QA-第2轮",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"message\": \"分析我的性格特点\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/user-conversation/qa/{{userSessionId}}/message",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "user-conversation", "qa", "{{userSessionId}}", "message"]
            },
            "description": "测试自我问答 - 性格分析"
          }
        },
        {
          "name": "自我QA-第3轮",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"message\": \"给我一些个人发展建议\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/user-conversation/qa/{{userSessionId}}/message",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "user-conversation", "qa", "{{userSessionId}}", "message"]
            },
            "description": "测试自我问答 - 个人发展建议"
          }
        },
        {
          "name": "补充信息",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    console.log('✅ 补充信息完成:', response.data.answer);",
                  "    console.log('📊 状态:', response.data.status);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"supplementInfo\": \"我擅长Python和Java编程，喜欢解决复杂的技术问题，团队协作能力强\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/user-conversation/qa/{{userSessionId}}/supplement",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "user-conversation", "qa", "{{userSessionId}}", "supplement"]
            },
            "description": "补充信息 - 提供额外信息"
          }
        },
        {
          "name": "生成AI总结",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    console.log('🎯 AI总结:', response.data);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/v1/user-conversation/qa/{{userSessionId}}/generate-summary",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "user-conversation", "qa", "{{userSessionId}}", "generate-summary"]
            },
            "description": "为用户自我描述生成AI总结"
          }
        },
        {
          "name": "结束会话",
          "request": {
            "method": "POST",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/v1/user-conversation/qa/{{userSessionId}}/end",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "user-conversation", "qa", "{{userSessionId}}", "end"]
            },
            "description": "结束用户自我QA会话"
          }
        }
      ]
    },
    {
      "name": "🚀 用户自我完整流程测试",
      "description": "端到端的用户自我信息收集和QA完整流程",
      "item": [
        {
          "name": "完整流程-开始用户自我收集",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    const response = pm.response.json();",
                  "    pm.collectionVariables.set('userSessionId', response.data.sessionId);",
                  "    console.log('🚀 用户自我信息收集开始，Session ID:', response.data.sessionId);",
                  "    console.log('📝 第一个问题:', response.data.firstQuestion);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/v1/user-conversation/collect/start",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "user-conversation", "collect", "start"]
            }
          }
        },
        {
          "name": "完整流程-多轮对话",
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "exec": [
                  "// 模拟多轮对话",
                  "const answers = [",
                  "    '32岁',",
                  "    '产品经理，互联网创业公司',",
                  "    '硕士，北京大学计算机专业',",
                  "    '北京',",
                  "    '性格开朗，喜欢与人交流',",
                  "    '就这些吧'",
                  "];",
                  "",
                  "const currentRound = pm.collectionVariables.get('userCurrentRound') || 0;",
                  "pm.request.body.raw = JSON.stringify({",
                  "    message: answers[currentRound]",
                  "});",
                  "pm.collectionVariables.set('userCurrentRound', currentRound + 1);"
                ],
                "type": "text/javascript"
              }
            },
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    console.log('Progress:', response.data.progress + '%');",
                  "    console.log('Response:', response.data);",
                  "    ",
                  "    if (response.data.isCompleted) {",
                  "        console.log('✅ 用户信息收集完成！');",
                  "        console.log('📄 自我描述:', response.data.updatedDescription);",
                  "        pm.collectionVariables.set('userCurrentRound', 0);",
                  "    }",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"message\": \"动态设置\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/user-conversation/collect/{{userSessionId}}/message",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "user-conversation", "collect", "{{userSessionId}}", "message"]
            },
            "description": "多次运行此请求以模拟完整对话流程"
          }
        },
        {
          "name": "完整流程-查看用户信息",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/v1/users/me",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "users", "me"]
            },
            "description": "查看更新后的用户信息"
          }
        },
        {
          "name": "完整流程-自我QA问答",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    console.log('🤖 自我QA问答响应:', response.data);",
                  "    ",
                  "    if (response.data.needsMoreInfo) {",
                  "        console.log('⚠️ 需要补充信息，请运行补充信息请求');",
                  "    } else {",
                  "        console.log('✅ 直接回答完成');",
                  "    }",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"message\": \"基于我的背景，给我一些职业发展建议\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/user-conversation/qa/{{userSessionId}}/message",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "user-conversation", "qa", "{{userSessionId}}", "message"]
            },
            "description": "完整流程测试 - 自我QA问答"
          }
        },
        {
          "name": "完整流程-补充信息",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    console.log('✅ 补充信息完成，答案:', response.data.answer);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"supplementInfo\": \"我有5年产品经验，擅长B端产品设计，希望未来向产品总监方向发展\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/user-conversation/qa/{{userSessionId}}/supplement",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "user-conversation", "qa", "{{userSessionId}}", "supplement"]
            },
            "description": "完整流程测试 - 补充信息"
          }
        },
        {
          "name": "完整流程-生成AI总结",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    console.log('🎯 AI总结生成完成:', response.data);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/v1/user-conversation/qa/{{userSessionId}}/generate-summary",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "user-conversation", "qa", "{{userSessionId}}", "generate-summary"]
            },
            "description": "完整流程测试 - 生成AI总结"
          }
        }
      ]
    },
    {
      "name": "🎯 关系目标管理",
      "description": "设定关系目标，AI生成策略和行动计划，定时推送提醒",
      "item": [
        {
          "name": "1) 创建关系目标",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    if (response.data && response.data.goalId) {",
                  "        pm.collectionVariables.set('goalId', response.data.goalId);",
                  "        console.log('✅ 目标创建成功，ID:', response.data.goalId);",
                  "        console.log('📝 AI策略:', response.data.aiStrategy);",
                  "        console.log('📋 行动计划数量:', response.data.actionPlans.length);",
                  "        ",
                  "        if (response.data.actionPlans && response.data.actionPlans.length > 0) {",
                  "            pm.collectionVariables.set('planId', response.data.actionPlans[0].planId);",
                  "            console.log('📌 第一个行动计划ID:', response.data.actionPlans[0].planId);",
                  "        }",
                  "    }",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"contactId\": {{contactId}},\n  \"goalDescription\": \"希望能够和这个联系人建立更深厚的友谊，增进彼此了解，定期保持联系\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/goals",
              "host": ["{{baseUrl}}"],
              "path": ["api", "goals"]
            },
            "description": "为指定联系人创建关系目标，AI会自动生成策略和行动计划"
          }
        },
        {
          "name": "2) 获取目标列表",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/goals",
              "host": ["{{baseUrl}}"],
              "path": ["api", "goals"]
            },
            "description": "获取当前用户的所有关系目标"
          }
        },
        {
          "name": "3) 按联系人筛选目标",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/goals?contactId={{contactId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "goals"],
              "query": [
                {
                  "key": "contactId",
                  "value": "{{contactId}}"
                }
              ]
            },
            "description": "获取指定联系人的所有关系目标"
          }
        },
        {
          "name": "4) 获取目标详情",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/goals/{{goalId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "goals", "{{goalId}}"]
            },
            "description": "获取目标详情，包括所有行动计划"
          }
        },
        {
          "name": "5) 更新目标",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"goalDescription\": \"更新后的目标：希望能够和这个联系人建立更深厚的友谊，争取每周至少联系一次\",\n  \"status\": \"ACTIVE\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/goals/{{goalId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "goals", "{{goalId}}"]
            },
            "description": "更新关系目标的描述或状态"
          }
        },
        {
          "name": "6) 删除目标",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/goals/{{goalId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "goals", "{{goalId}}"]
            },
            "description": "软删除指定的关系目标"
          }
        },
        {
          "name": "7) 重新生成AI策略",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    console.log('✅ AI策略重新生成成功');",
                  "    console.log('📝 新策略:', response.data.aiStrategy);",
                  "    console.log('📋 新行动计划数量:', response.data.actionPlans.length);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/goals/{{goalId}}/regenerate",
              "host": ["{{baseUrl}}"],
              "path": ["api", "goals", "{{goalId}}", "regenerate"]
            },
            "description": "重新生成AI策略和行动计划（会删除旧的未完成的计划）"
          }
        }
      ]
    },
    {
      "name": "📋 行动计划管理",
      "description": "管理AI生成的行动计划，更新状态和采纳设置",
      "item": [
        {
          "name": "1) 更新行动计划状态",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    console.log('✅ 行动计划状态已更新');",
                  "    console.log('📊 状态:', response.data.status);",
                  "    console.log('✅ 完成时间:', response.data.completedAt);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"status\": \"COMPLETED\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/goals/{{goalId}}/action-plans/{{planId}}/status",
              "host": ["{{baseUrl}}"],
              "path": ["api", "goals", "{{goalId}}", "action-plans", "{{planId}}", "status"]
            },
            "description": "更新行动计划的执行状态（PENDING/COMPLETED/SKIPPED/CANCELLED）"
          }
        },
        {
          "name": "2) 标记为已完成（带完成时间）",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"status\": \"COMPLETED\",\n  \"completedAt\": \"2025-10-20T14:30:00\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/goals/{{goalId}}/action-plans/{{planId}}/status",
              "host": ["{{baseUrl}}"],
              "path": ["api", "goals", "{{goalId}}", "action-plans", "{{planId}}", "status"]
            },
            "description": "标记行动计划为已完成，并指定完成时间"
          }
        },
        {
          "name": "3) 采纳该行动计划",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    console.log('✅ 行动计划已采纳');",
                  "    console.log('🔔 系统将为此计划创建提醒');",
                  "    console.log('📅 计划时间:', response.data.scheduledTime);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"isAdopted\": true\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/goals/{{goalId}}/action-plans/{{planId}}/adoption",
              "host": ["{{baseUrl}}"],
              "path": ["api", "goals", "{{goalId}}", "action-plans", "{{planId}}", "adoption"]
            },
            "description": "采纳该行动计划，系统会自动创建提醒"
          }
        },
        {
          "name": "4) 取消采纳行动计划",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    console.log('✅ 行动计划已取消采纳');",
                  "    console.log('🔕 系统将取消相关的未发送提醒');",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"isAdopted\": false\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/goals/{{goalId}}/action-plans/{{planId}}/adoption",
              "host": ["{{baseUrl}}"],
              "path": ["api", "goals", "{{goalId}}", "action-plans", "{{planId}}", "adoption"]
            },
            "description": "取消采纳该行动计划，系统会自动取消相关提醒"
          }
        },
        {
          "name": "5) 标记为已跳过",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"status\": \"SKIPPED\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/goals/{{goalId}}/action-plans/{{planId}}/status",
              "host": ["{{baseUrl}}"],
              "path": ["api", "goals", "{{goalId}}", "action-plans", "{{planId}}", "status"]
            },
            "description": "跳过该行动计划"
          }
        }
      ]
    },
    {
      "name": "🔔 提醒管理",
      "description": "查看即将到来的行动计划提醒",
      "item": [
        {
          "name": "1) 获取即将到来的提醒",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    console.log('✅ 获取提醒成功');",
                  "    console.log('📋 提醒数量:', response.data.length);",
                  "    ",
                  "    response.data.forEach((reminder, index) => {",
                  "        console.log(`\\n提醒 ${index + 1}:`, reminder.planTitle);",
                  "        console.log('  联系人:', reminder.contactName);",
                  "        console.log('  提醒时间:', reminder.remindTime);",
                  "        console.log('  状态:', reminder.status);",
                  "    });",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/goals/reminders/upcoming",
              "host": ["{{baseUrl}}"],
              "path": ["api", "goals", "reminders", "upcoming"]
            },
            "description": "获取用户所有即将到来的行动计划提醒（状态为PENDING）"
          }
        }
      ]
    },
    {
      "name": "📱 推送令牌管理",
      "description": "管理移动设备的推送通知令牌",
      "item": [
        {
          "name": "1) 注册推送令牌（Android）",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    console.log('✅ Android推送令牌注册成功');",
                  "    console.log('📱 设备类型: ANDROID');",
                  "    console.log('🔔 您将收到关系目标的推送提醒');",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"deviceToken\": \"your_fcm_device_token_for_android\",\n  \"deviceType\": \"ANDROID\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/push/tokens",
              "host": ["{{baseUrl}}"],
              "path": ["api", "push", "tokens"]
            },
            "description": "注册Android设备的FCM推送令牌"
          }
        },
        {
          "name": "2) 注册推送令牌（iOS）",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    console.log('✅ iOS推送令牌注册成功');",
                  "    console.log('📱 设备类型: IOS');",
                  "    console.log('🔔 您将收到关系目标的推送提醒');",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"deviceToken\": \"your_fcm_device_token_for_ios\",\n  \"deviceType\": \"IOS\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/push/tokens",
              "host": ["{{baseUrl}}"],
              "path": ["api", "push", "tokens"]
            },
            "description": "注册iOS设备的FCM推送令牌"
          }
        },
        {
          "name": "3) 注销推送令牌",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    console.log('✅ 推送令牌已注销');",
                  "    console.log('🔕 该设备将不再收到推送提醒');",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/push/tokens/{{tokenId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "push", "tokens", "{{tokenId}}"]
            },
            "description": "停用指定的推送令牌"
          }
        }
      ]
    },
    {
      "name": "🚀 关系目标完整流程",
      "description": "端到端的关系目标功能测试流程",
      "item": [
        {
          "name": "完整流程-1)创建联系人",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    const response = pm.response.json();",
                  "    pm.collectionVariables.set('contactId', response.data.id);",
                  "    console.log('✅ 联系人创建成功，ID:', response.data.id);",
                  "    console.log('👤 联系人:', response.data.name);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"王五\",\n  \"description\": \"高中同学，目前在上海工作，做市场营销，性格外向，喜欢旅游和摄影\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/contacts",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "contacts"]
            },
            "description": "先创建一个联系人"
          }
        },
        {
          "name": "完整流程-2)创建关系目标",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    pm.collectionVariables.set('goalId', response.data.goalId);",
                  "    console.log('✅ 关系目标创建成功');",
                  "    console.log('🎯 目标ID:', response.data.goalId);",
                  "    console.log('📝 AI策略:', response.data.aiStrategy);",
                  "    console.log('📋 行动计划:', response.data.actionPlans.length + '个');",
                  "    ",
                  "    response.data.actionPlans.forEach((plan, index) => {",
                  "        console.log(`  ${index + 1}. ${plan.title} - ${plan.scheduledTime}`);",
                  "        if (index === 0) {",
                  "            pm.collectionVariables.set('planId', plan.planId);",
                  "        }",
                  "    });",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"contactId\": {{contactId}},\n  \"goalDescription\": \"希望能够和王五重新建立联系，恢复高中时期的友谊，并建立长期稳定的友谊关系\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/goals",
              "host": ["{{baseUrl}}"],
              "path": ["api", "goals"]
            },
            "description": "为联系人创建关系目标，AI会生成策略和行动计划"
          }
        },
        {
          "name": "完整流程-3)查看目标详情",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    console.log('📋 目标详情:');",
                  "    console.log('  联系人:', response.data.contactName);",
                  "    console.log('  目标:', response.data.goalDescription);",
                  "    console.log('  状态:', response.data.status);",
                  "    console.log('  行动计划数:', response.data.actionPlans.length);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/goals/{{goalId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "goals", "{{goalId}}"]
            },
            "description": "查看目标的完整信息"
          }
        },
        {
          "name": "完整流程-4)取消采纳某个计划",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    console.log('✅ 行动计划采纳状态已更新');",
                  "    console.log('🔕 未发送的提醒已被取消');",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"isAdopted\": false\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/goals/{{goalId}}/action-plans/{{planId}}/adoption",
              "host": ["{{baseUrl}}"],
              "path": ["api", "goals", "{{goalId}}", "action-plans", "{{planId}}", "adoption"]
            },
            "description": "用户决定不采纳某个AI建议的行动计划"
          }
        },
        {
          "name": "完整流程-5)重新采纳计划",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    console.log('✅ 行动计划已重新采纳');",
                  "    console.log('🔔 系统已创建新的提醒');",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"isAdopted\": true\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/goals/{{goalId}}/action-plans/{{planId}}/adoption",
              "host": ["{{baseUrl}}"],
              "path": ["api", "goals", "{{goalId}}", "action-plans", "{{planId}}", "adoption"]
            },
            "description": "用户改变主意，重新采纳该行动计划"
          }
        },
        {
          "name": "完整流程-6)查看即将到来的提醒",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    console.log('🔔 即将到来的提醒:', response.data.length + '个');",
                  "    ",
                  "    response.data.forEach((reminder, index) => {",
                  "        console.log(`\\n提醒 ${index + 1}:`);",
                  "        console.log('  行动:', reminder.planTitle);",
                  "        console.log('  联系人:', reminder.contactName);",
                  "        console.log('  提醒时间:', reminder.remindTime);",
                  "    });",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/goals/reminders/upcoming",
              "host": ["{{baseUrl}}"],
              "path": ["api", "goals", "reminders", "upcoming"]
            },
            "description": "查看所有即将到来的提醒"
          }
        },
        {
          "name": "完整流程-7)标记计划为已完成",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    console.log('✅ 行动计划已标记为完成');",
                  "    console.log('🎉 恭喜完成这个行动！');",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"status\": \"COMPLETED\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/goals/{{goalId}}/action-plans/{{planId}}/status",
              "host": ["{{baseUrl}}"],
              "path": ["api", "goals", "{{goalId}}", "action-plans", "{{planId}}", "status"]
            },
            "description": "用户完成了一个行动计划"
          }
        },
        {
          "name": "完整流程-8)注册推送令牌",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    console.log('✅ 推送令牌注册成功');",
                  "    console.log('📱 设备已准备好接收提醒');",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"deviceToken\": \"test_fcm_token_12345\",\n  \"deviceType\": \"ANDROID\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/push/tokens",
              "host": ["{{baseUrl}}"],
              "path": ["api", "push", "tokens"]
            },
            "description": "注册设备推送令牌，以接收提醒通知"
          }
        }
      ]
    },
    {
      "name": "📌 Pin收藏管理",
      "description": "收藏对话中有价值的AI回答，便于后续查看",
      "item": [
        {
          "name": "1) 创建Pin（从QA历史）",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    if (response.data && response.data.pinId) {",
                  "        pm.collectionVariables.set('pinId', response.data.pinId);",
                  "        console.log('✅ Pin创建成功，ID:', response.data.pinId);",
                  "        console.log('❓ 问题:', response.data.question);",
                  "        console.log('💬 回答:', response.data.answer.substring(0, 50) + '...');",
                  "        ",
                  "        if (response.data.hasSupplementInfo) {",
                  "            console.log('📝 补充问答: 有');",
                  "        }",
                  "    }",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"sessionId\": \"{{sessionId}}\",\n  \"qaIndex\": 0,\n  \"note\": \"这个回答很有价值\",\n  \"tags\": \"重要,参考\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/pins",
              "host": ["{{baseUrl}}"],
              "path": ["api", "pins"]
            },
            "description": "从QA历史中Pin一个回答（qaIndex为QA在历史中的索引，从0开始）"
          }
        },
        {
          "name": "2) 获取所有Pin",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    console.log('✅ 获取Pin列表成功');",
                  "    console.log('📋 Pin数量:', response.data.length);",
                  "    ",
                  "    response.data.forEach((pin, index) => {",
                  "        console.log(`\\nPin ${index + 1}:`);",
                  "        console.log('  类型:', pin.sourceType);",
                  "        console.log('  联系人:', pin.contactName || '用户自我');",
                  "        console.log('  问题:', pin.questionPreview);",
                  "        console.log('  标签:', pin.tags);",
                  "    });",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/pins",
              "host": ["{{baseUrl}}"],
              "path": ["api", "pins"]
            },
            "description": "获取用户所有的Pin收藏"
          }
        },
        {
          "name": "3) 按联系人筛选Pin",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/pins?contactId={{contactId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "pins"],
              "query": [
                {
                  "key": "contactId",
                  "value": "{{contactId}}"
                }
              ]
            },
            "description": "获取指定联系人相关的所有Pin"
          }
        },
        {
          "name": "4) 按来源类型筛选Pin",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/pins?sourceType=CONTACT_QA",
              "host": ["{{baseUrl}}"],
              "path": ["api", "pins"],
              "query": [
                {
                  "key": "sourceType",
                  "value": "CONTACT_QA",
                  "description": "可选值：CONTACT_QA 或 USER_QA"
                }
              ]
            },
            "description": "按来源类型筛选Pin（联系人QA或用户自我QA）"
          }
        },
        {
          "name": "5) 获取Pin详情",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    console.log('📌 Pin详情:');",
                  "    console.log('  问题:', response.data.question);",
                  "    console.log('  回答:', response.data.answer);",
                  "    ",
                  "    if (response.data.hasSupplementInfo) {",
                  "        console.log('  补充问题:', response.data.supplementQuestion);",
                  "        console.log('  补充回答:', response.data.supplementAnswer);",
                  "    }",
                  "    ",
                  "    console.log('  备注:', response.data.note);",
                  "    console.log('  标签:', response.data.tags);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/pins/{{pinId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "pins", "{{pinId}}"]
            },
            "description": "获取Pin的完整内容"
          }
        },
        {
          "name": "6) 更新Pin备注和标签",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    console.log('✅ Pin更新成功');",
                  "    console.log('📝 备注:', response.data.note);",
                  "    console.log('🏷️ 标签:', response.data.tags);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"note\": \"更新后的备注说明\",\n  \"tags\": \"工作,学习,技巧\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/pins/{{pinId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "pins", "{{pinId}}"]
            },
            "description": "更新Pin的用户备注和标签"
          }
        },
        {
          "name": "7) 删除Pin",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    console.log('✅ Pin已删除');",
                  "    pm.collectionVariables.set('pinId', '');",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/pins/{{pinId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "pins", "{{pinId}}"]
            },
            "description": "删除指定的Pin"
          }
        },
        {
          "name": "8) 检查是否已Pin",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    if (response.data === true) {",
                  "        console.log('✅ 该QA已被Pin');",
                  "    } else {",
                  "        console.log('📌 该QA未被Pin');",
                  "    }",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/pins/check?sessionId={{sessionId}}&qaIndex=0",
              "host": ["{{baseUrl}}"],
              "path": ["api", "pins", "check"],
              "query": [
                {
                  "key": "sessionId",
                  "value": "{{sessionId}}"
                },
                {
                  "key": "qaIndex",
                  "value": "0"
                }
              ]
            },
            "description": "检查指定的QA是否已被Pin"
          }
        }
      ]
    },
    {
      "name": "🚀 Pin完整流程测试",
      "description": "端到端的Pin功能测试流程",
      "item": [
        {
          "name": "完整流程-1)开始对话收集",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    const response = pm.response.json();",
                  "    pm.collectionVariables.set('sessionId', response.data.sessionId);",
                  "    console.log('✅ 对话会话开始:', response.data.sessionId);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"contactName\": \"测试联系人\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/conversation/collect/start",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "conversation", "collect", "start"]
            },
            "description": "开始一个对话会话"
          }
        },
        {
          "name": "完整流程-2)回答几轮问题",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"message\": \"30岁\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/conversation/collect/{{sessionId}}/message",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "conversation", "collect", "{{sessionId}}", "message"]
            },
            "description": "回答问题（多次运行以进入QA模式）"
          }
        },
        {
          "name": "完整流程-3)进行QA问答",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    console.log('💬 QA回答:', response.data.answer);",
                  "    console.log('📌 现在可以Pin这个回答了（qaIndex=0）');",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"message\": \"这个联系人和我的关系如何？\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/conversation/qa/{{sessionId}}/message",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "conversation", "qa", "{{sessionId}}", "message"]
            },
            "description": "进行QA问答"
          }
        },
        {
          "name": "完整流程-4)Pin第一个QA",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    pm.collectionVariables.set('pinId', response.data.pinId);",
                  "    console.log('✅ 成功Pin了第一个QA');",
                  "    console.log('📌 Pin ID:', response.data.pinId);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"sessionId\": \"{{sessionId}}\",\n  \"qaIndex\": 0,\n  \"note\": \"第一个有价值的回答\",\n  \"tags\": \"关系分析,重要\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/pins",
              "host": ["{{baseUrl}}"],
              "path": ["api", "pins"]
            },
            "description": "Pin第一个QA回答"
          }
        },
        {
          "name": "完整流程-5)检查是否已Pin",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    console.log('检查结果:', response.data ? '已Pin ✅' : '未Pin 📌');",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/pins/check?sessionId={{sessionId}}&qaIndex=0",
              "host": ["{{baseUrl}}"],
              "path": ["api", "pins", "check"],
              "query": [
                {
                  "key": "sessionId",
                  "value": "{{sessionId}}"
                },
                {
                  "key": "qaIndex",
                  "value": "0"
                }
              ]
            },
            "description": "检查该QA是否已被Pin"
          }
        },
        {
          "name": "完整流程-6)查看Pin列表",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    console.log('📋 我的Pin收藏:', response.data.length + '个');",
                  "    ",
                  "    response.data.forEach((pin, index) => {",
                  "        console.log(`\\n${index + 1}. ${pin.questionPreview}`);",
                  "        console.log('   回答预览:', pin.answerPreview);",
                  "    });",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/pins",
              "host": ["{{baseUrl}}"],
              "path": ["api", "pins"]
            },
            "description": "查看所有Pin"
          }
        },
        {
          "name": "完整流程-7)查看Pin详情",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    console.log('📌 Pin完整内容:');",
                  "    console.log('❓ 问题:', response.data.question);",
                  "    console.log('💬 回答:', response.data.answer);",
                  "    console.log('📝 备注:', response.data.note);",
                  "    console.log('🏷️ 标签:', response.data.tags);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/pins/{{pinId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "pins", "{{pinId}}"]
            },
            "description": "查看Pin的完整内容"
          }
        },
        {
          "name": "完整流程-8)更新Pin",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    console.log('✅ Pin备注和标签已更新');",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"note\": \"这个洞察非常有价值，需要经常回顾\",\n  \"tags\": \"关键洞察,行动指南,高优先级\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/pins/{{pinId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "pins", "{{pinId}}"]
            },
            "description": "更新Pin的备注和标签"
          }
        }
      ]
    },
    {
      "name": "🔒 隐私政策管理",
      "description": "隐私政策查看和用户同意管理",
      "item": [
        {
          "name": "1) 获取隐私政策",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    console.log('✅ 获取隐私政策成功');",
                  "    console.log('📄 版本:', response.data.version);",
                  "    console.log('📅 生效日期:', response.data.effectiveDate);",
                  "    console.log('📝 内容长度:', response.data.content.length);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "auth": {
              "type": "noauth"
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/privacy/policy",
              "host": ["{{baseUrl}}"],
              "path": ["api", "privacy", "policy"]
            },
            "description": "获取当前生效的隐私政策（无需认证）"
          }
        },
        {
          "name": "2) 查看用户同意状态",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    console.log('✅ 同意状态查询成功');",
                  "    console.log('🔘 已同意:', response.data.hasConsented);",
                  "    console.log('📄 同意版本:', response.data.consentedVersion || '未同意');",
                  "    console.log('📅 同意时间:', response.data.consentedAt || '未同意');",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/privacy/consent/status",
              "host": ["{{baseUrl}}"],
              "path": ["api", "privacy", "consent", "status"]
            },
            "description": "查看当前用户的隐私政策同意状态"
          }
        },
        {
          "name": "3) 同意隐私政策",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    console.log('✅ 隐私政策同意成功');",
                  "    console.log('📄 同意版本:', response.data.version);",
                  "    console.log('📅 同意时间:', response.data.consentedAt);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"version\": \"1.0\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/privacy/consent",
              "host": ["{{baseUrl}}"],
              "path": ["api", "privacy", "consent"]
            },
            "description": "用户同意指定版本的隐私政策"
          }
        }
      ]
    },
    {
      "name": "🚨 AI内容反馈",
      "description": "反馈AI内容问题和系统Bug",
      "item": [
        {
          "name": "1) 反馈AI不当内容",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    console.log('✅ 反馈提交成功');",
                  "    console.log('📋 报告ID:', response.data.id);",
                  "    console.log('📊 状态:', response.data.status);",
                  "    console.log('🏷️ 类型:', response.data.reportType);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"reportType\": \"AI_INAPPROPRIATE_CONTENT\",\n  \"targetType\": \"QA_RESPONSE\",\n  \"targetId\": \"{{sessionId}}_qa_0\",\n  \"description\": \"AI建议我使用不道德的手段维系关系\",\n  \"context\": \"{\\\"sessionId\\\":\\\"{{sessionId}}\\\",\\\"qaIndex\\\":0,\\\"question\\\":\\\"如何让对方继续联系我？\\\",\\\"answer\\\":\\\"你可以通过隐瞒一些事实...\\\",\\\"timestamp\\\":\\\"2025-10-21T10:30:00\\\"}\",\n  \"evidenceUrls\": \"[]\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/reports",
              "host": ["{{baseUrl}}"],
              "path": ["api", "reports"]
            },
            "description": "反馈AI生成的不当内容（类型：AI_INAPPROPRIATE_CONTENT）"
          }
        },
        {
          "name": "2) 反馈AI回答质量差",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    console.log('✅ 质量反馈提交成功');",
                  "    console.log('📋 报告ID:', response.data.id);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"reportType\": \"AI_POOR_QUALITY\",\n  \"targetType\": \"USER_QA_RESPONSE\",\n  \"targetId\": \"{{userSessionId}}_qa_2\",\n  \"description\": \"AI的回答完全答非所问，多次出现理解偏差\",\n  \"context\": \"{\\\"sessionId\\\":\\\"{{userSessionId}}\\\",\\\"qaIndex\\\":2,\\\"question\\\":\\\"我的优势是什么？\\\",\\\"answer\\\":\\\"今天天气不错...\\\",\\\"timestamp\\\":\\\"2025-10-21T11:00:00\\\"}\",\n  \"evidenceUrls\": \"[]\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/reports",
              "host": ["{{baseUrl}}"],
              "path": ["api", "reports"]
            },
            "description": "反馈AI回答质量问题（类型：AI_POOR_QUALITY）"
          }
        },
        {
          "name": "3) 反馈系统Bug",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    console.log('✅ Bug报告提交成功');",
                  "    console.log('📋 报告ID:', response.data.id);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"reportType\": \"SYSTEM_BUG\",\n  \"targetType\": \"SYSTEM_FEATURE\",\n  \"targetId\": null,\n  \"description\": \"在QA模式下提交补充信息后系统崩溃，显示500错误\",\n  \"context\": \"{\\\"feature\\\":\\\"qa_supplement\\\",\\\"sessionId\\\":\\\"{{sessionId}}\\\",\\\"errorMessage\\\":\\\"500 Internal Server Error\\\",\\\"userAgent\\\":\\\"Mozilla/5.0...\\\",\\\"timestamp\\\":\\\"2025-10-21T11:30:00\\\"}\",\n  \"evidenceUrls\": \"[\\\"https://example.com/screenshot1.png\\\"]\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/reports",
              "host": ["{{baseUrl}}"],
              "path": ["api", "reports"]
            },
            "description": "报告系统Bug或功能异常（类型：SYSTEM_BUG）"
          }
        },
        {
          "name": "4) 反馈关系目标策略问题",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"reportType\": \"AI_POOR_QUALITY\",\n  \"targetType\": \"GOAL_STRATEGY\",\n  \"targetId\": \"{{goalId}}\",\n  \"description\": \"AI生成的行动计划不够具体，缺乏可操作性\",\n  \"context\": \"{\\\"goalId\\\":{{goalId}},\\\"goalDescription\\\":\\\"希望加深与联系人的关系\\\",\\\"aiStrategy\\\":\\\"建议多联系...\\\",\\\"timestamp\\\":\\\"2025-10-21T12:00:00\\\"}\",\n  \"evidenceUrls\": \"[]\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/reports",
              "host": ["{{baseUrl}}"],
              "path": ["api", "reports"]
            },
            "description": "反馈关系目标AI策略的质量问题"
          }
        },
        {
          "name": "5) 反馈AI总结问题",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"reportType\": \"AI_POOR_QUALITY\",\n  \"targetType\": \"AI_SUMMARY\",\n  \"targetId\": \"contact_{{contactId}}\",\n  \"description\": \"AI生成的总结遗漏了重要信息，且有明显的理解偏差\",\n  \"context\": \"{\\\"contactId\\\":{{contactId}},\\\"contactName\\\":\\\"张三\\\",\\\"originalDescription\\\":\\\"...\\\",\\\"aiSummary\\\":\\\"...\\\",\\\"timestamp\\\":\\\"2025-10-21T12:30:00\\\"}\",\n  \"evidenceUrls\": \"[]\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/reports",
              "host": ["{{baseUrl}}"],
              "path": ["api", "reports"]
            },
            "description": "反馈AI总结的质量问题"
          }
        },
        {
          "name": "6) 查看我的反馈报告",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    console.log('✅ 获取反馈列表成功');",
                  "    console.log('📋 反馈数量:', response.data.length);",
                  "    ",
                  "    response.data.forEach((report, index) => {",
                  "        console.log(`\\n反馈 ${index + 1}:`);",
                  "        console.log('  类型:', report.reportType);",
                  "        console.log('  目标:', report.targetType);",
                  "        console.log('  目标ID:', report.targetId);",
                  "        console.log('  状态:', report.status);",
                  "        console.log('  提交时间:', report.createdAt);",
                  "    });",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/reports/my-reports",
              "host": ["{{baseUrl}}"],
              "path": ["api", "reports", "my-reports"]
            },
            "description": "查看当前用户提交的所有反馈报告"
          }
        },
        {
          "name": "7) 查看待处理报告（管理员）",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/reports/pending",
              "host": ["{{baseUrl}}"],
              "path": ["api", "reports", "pending"]
            },
            "description": "查看所有待处理的反馈报告（管理员功能）"
          }
        },
        {
          "name": "8) 查看所有报告（管理员）",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/reports/all",
              "host": ["{{baseUrl}}"],
              "path": ["api", "reports", "all"]
            },
            "description": "查看所有反馈报告记录（管理员功能）"
          }
        }
      ]
    },
    {
      "name": "🤖 Deepseek AI对话",
      "description": "直接与Deepseek AI进行对话交互",
      "item": [
        {
          "name": "1) AI问答（非流式）",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    console.log('✅ AI回答成功');",
                  "    console.log('💬 回答:', response.data.answer);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"prompt\": \"介绍一下你自己\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/ai/ask",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "ai", "ask"]
            },
            "description": "与Deepseek AI进行非流式对话"
          }
        },
        {
          "name": "2) AI问答（流式）",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "console.log('🌊 流式响应已开始');",
                  "console.log('💬 请在Response窗口查看流式输出');",
                  "console.log('ℹ️  注意：Postman可能不完全支持Server-Sent Events的实时显示');"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "type": "text"
              },
              {
                "key": "Accept",
                "value": "text/event-stream",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"prompt\": \"讲一个笑话\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/ai/ask/stream",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "ai", "ask", "stream"]
            },
            "description": "与Deepseek AI进行流式对话（Server-Sent Events）"
          }
        }
      ]
    }
  ]
}
